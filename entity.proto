// 实体Proto结构定义

syntax = "proto3";

package game.gia.asset.entity;

// 实体
message Entity {
    EntityData data = 1;                  // 实体数据
    int32 field_2 = 2;                    // 未知字段 (值为0)
    int32 template_id = 4;                // 模板ID
}

// 实体数据
message EntityData {
    int32 entity_id = 1;                  // 实体ID
    TemplateReference template = 2;       // 模板引用
    repeated Property properties = 5;     // 属性列表
    repeated Component components = 6;    // 组件列表
    repeated bytes field_7 = 7;           // 未知字段
    int32 template_id_ref = 8;            // 模板ID引用
}

// 模板引用
message TemplateReference {
    int32 template_id = 1;                // 模板ID
    int32 field_2 = 2;                    // 未知字段 (值为1)
}

// 属性
message Property {
    PropertyType property_type = 1;       // 属性类型

    oneof value {
        NameProperty name = 11;           // 名称 (property_type=1)
        RemarkProperty remark = 22;       // 备注 (property_type=13)
        bytes field_23 = 23;              // 动作组？ (property_type=14)
        bytes field_28 = 28;              // 未知 (property_type=19)
        bytes field_48 = 48;              // 未知 (property_type=38)
        bytes field_50 = 50;              // 未知 (property_type=40)
        bytes field_62 = 62;              // 未知 (property_type=52)
        bytes field_65 = 65;              // 未知 (property_type=61)
        bytes field_66 = 66;              // 未知 (property_type=62)
    }

    enum PropertyType {
        UNKNOWN = 0;
        NAME = 1;
        REMARK = 13;
    }
}

// 名称属性
message NameProperty {
    string name = 1;                // 名称
    StaticBlock static_block = 2;   // 动态单位、静态单位

    enum StaticBlock {
        DYNAMIC = 0;
        STATIC = 1;
    }
}

// 备注属性
message RemarkProperty {
    string remark = 1;              // 备注
}

// 组件
message Component {
    ComponentType component_type = 1;               // 组件类型

    oneof component_data {
        TransformComponent transform = 11;          // 变换组件 (property_type=1)
        PresetStateComponent preset_state = 12;     // 预设状态组件 (property_type=2)
        bytes field_13 = 13;                        // 未知 (property_type=3)
        bytes field_14 = 14;                        // 未知 (property_type=4)
        bytes field_15 = 15;                        // 未知 (property_type=5)
        bytes field_16 = 16;                        // 未知 (property_type=6)
        BasicCombatComponent basic_combat = 17;     // 基础战斗属性组件 (property_type=7)
        bytes field_18 = 18;                        // 未知 (property_type=8)
        NodeComponent node = 21;                    // 单位挂接点组件 (property_type=11)
        bytes field_22 = 22;                        // 未知 (property_type=12)
        bytes field_27 = 27;                        // 未知 (property_type=17)
        bytes field_29 = 29;                        // 未知 (property_type=19)
    }

    enum ComponentType {
        UNKNOWN = 0;
        TRANSFORM = 1;
        PRESET_STATE = 2;
        BASIC_COMBAT = 7;
        NODE = 11;
    }
}

// 变换组件
message TransformComponent {
    Position position = 1;         // 位置数据
    Rotation rotation = 2;         // 旋转数据
    Scale scale = 3;               // 缩放数据
    uint32 field_501 = 501;        // 未知字段 (值为4294967295，-1)
}

// 位置数据
message Position {
    float x = 1;                   // X轴坐标
    float y = 2;                   // Y轴坐标
    float z = 3;                   // Z轴坐标
}

// 旋转数据
message Rotation {
    float x = 1;                   // X轴旋转
    float y = 2;                   // Y轴旋转
    float z = 3;                   // Z轴旋转
}

// 三维缩放
message Scale {
    float x = 1;                   // X轴缩放
    float y = 2;                   // Y轴缩放
    float z = 3;                   // Z轴缩放
}

// 预设状态组件
message PresetStateComponent {
    PresetState preset_state = 2;  // 预设状态数据
}

// 预设状态数据
message PresetState {
    int32 preset_state_id = 1;     // 预设状态索引
    int32 preset_state = 2;        // 预设状态
}

// 基础战斗属性组件
message BasicCombatComponent {
    float base_health = 1;           // 基础生命值
    float base_attack = 2;           // 基础攻击力
    float basic_defense = 3;         // 基础防御力
    IsInvincible is_invincible = 4;  // 是否无敌
    int32 level = 5;                 // 等级
    bytes field_6 = 6;               // 未知
    float field_8 = 8;               // 未知
    float field_9 = 9;               // 未知
    float field_10 = 10;             // 未知
    float field_11 = 11;             // 未知
    float field_12 = 12;             // 未知
    float field_13 = 13;             // 未知
    float field_14 = 14;             // 未知
    float field_15 = 15;             // 未知

    enum IsInvincible {
        NOT_INVINCIBLE = 0;
        INVINCIBLE = 1;
    }
}

// 单位挂接点组件
message NodeComponent {
    NodeInfo node_info = 1;          // 节点信息
}

// 节点信息
message NodeInfo {
    string id = 1;                   // 节点id ("GI_RootNode")
    bytes field_2 = 2;               // 未知
    bytes field_3 = 3;               // 未知
    string description = 502;        // 描述 ("中心原点")
    int32 field_504 = 504;           // 未知 (值为1)
    string name = 505;               // 节点名称 ("RootNode")
}
